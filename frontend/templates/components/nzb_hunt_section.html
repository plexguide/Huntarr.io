<!-- NZB Hunt Section - Standalone module (independent of Movie Hunt / Requestarr) -->
<section id="nzb-hunt-section" class="content-section" style="display: none;">
    <link rel="stylesheet" href="./static/css/nzb-hunt.css">
    {% set phb_back_hash = '#home' %}{% set phb_icon = 'fa-download' %}{% set phb_section = 'NZB Hunt' %}{% set phb_page
    = 'Downloads' %}
    {% include 'components/page_header_partial.html' %}
    <div class="nzb-hunt-container">

        <!-- Status bar -->
        <div class="nzb-status-bar">
            <div class="nzb-status-metrics">
                <div class="nzb-status-item nzb-active-connections" id="nzb-active-connections"
                    title="Hover for connections per server">
                    <i class="fas fa-plug"></i>
                    <span class="nzb-status-value" id="nzb-active-connections-value">0</span>
                    <span class="nzb-status-label">Connections</span>
                    <div class="nzb-status-tooltip" id="nzb-active-connections-tooltip">No servers configured</div>
                </div>
                <div class="nzb-status-item nzb-speed-control" id="nzb-speed-control" title="Click to set speed limit">
                    <i class="fas fa-tachometer-alt"></i>
                    <span class="nzb-status-value" id="nzb-speed">0 B/s</span>
                    <span class="nzb-status-label">Speed</span>
                    <i class="fas fa-caret-down nzb-speed-chevron"></i>
                    <span class="nzb-speed-limit-badge" id="nzb-speed-limit-badge" style="display: none;"></span>
                    <div class="nzb-speed-popover" id="nzb-speed-popover" style="display: none;">
                        <div class="nzb-speed-popover-title">Speed Limit</div>
                        <div class="nzb-speed-popover-options">
                            <button class="nzb-speed-opt" data-limit="0">Unlimited</button>
                            <button class="nzb-speed-opt" data-limit="1048576">1 MB/s</button>
                            <button class="nzb-speed-opt" data-limit="2621440">2.5 MB/s</button>
                            <button class="nzb-speed-opt" data-limit="5242880">5 MB/s</button>
                            <button class="nzb-speed-opt" data-limit="10485760">10 MB/s</button>
                            <button class="nzb-speed-opt" data-limit="26214400">25 MB/s</button>
                            <button class="nzb-speed-opt" data-limit="52428800">50 MB/s</button>
                        </div>
                        <div class="nzb-speed-popover-custom">
                            <input type="number" id="nzb-speed-custom-input" placeholder="Custom MB/s" min="0"
                                step="0.5">
                            <button class="nzb-btn nzb-btn-primary nzb-speed-custom-btn"
                                id="nzb-speed-custom-btn">Set</button>
                        </div>
                    </div>
                </div>
                <div class="nzb-status-item">
                    <i class="fas fa-clock"></i>
                    <span class="nzb-status-value" id="nzb-eta">--</span>
                    <span class="nzb-status-label">ETA</span>
                </div>
                <div class="nzb-status-item">
                    <i class="fas fa-download"></i>
                    <span class="nzb-status-value" id="nzb-remaining">0 B</span>
                    <span class="nzb-status-label">Remaining</span>
                </div>
                <div class="nzb-status-item">
                    <i class="fas fa-hdd"></i>
                    <span class="nzb-status-value" id="nzb-free-space">--</span>
                    <span class="nzb-status-label">Space</span>
                </div>
            </div>
            <div class="nzb-status-actions">
                <button class="nzb-btn nzb-btn-pause" id="nzb-pause-btn" title="Pause / Resume all downloads">
                    <i class="fas fa-pause"></i>
                </button>
                <button class="nzb-display-prefs-btn" id="nzb-display-prefs-btn" title="Display Settings">
                    <i class="fas fa-cog"></i>
                </button>
            </div>
        </div>

        <!-- Warning when NZB Hunt is not configured as a download client -->
        <div class="nzb-client-warning" id="nzb-client-warning" style="display: none;">
            <i class="fas fa-info-circle" aria-hidden="true"></i>
            <div class="nzb-client-warning-content">
                <strong>NZB Hunt is not connected yet.</strong> Create a Movie Hunt or TV Hunt instance in <a
                    href="./#media-hunt-instances" class="nzb-client-warning-link">Media Hunt → Instances</a> —
                NZB Hunt will be added as a download client automatically.
            </div>
        </div>

        <!-- Tabs -->
        <div class="nzb-tabs">
            <button class="nzb-tab active" data-tab="queue">
                Queue <span class="nzb-tab-badge nzb-tab-badge-default" id="nzb-queue-count">0</span>
            </button>
            <button class="nzb-tab" data-tab="history">
                History <span class="nzb-tab-badge nzb-tab-badge-default" id="nzb-history-count">0</span>
            </button>
            <button class="nzb-tab" data-tab="warnings" id="nzb-warnings-tab" style="display: none;">
                Warnings <span class="nzb-tab-badge nzb-tab-badge-warn" id="nzb-warnings-count">0</span>
            </button>
        </div>

        <!-- Queue panel -->
        <div class="nzb-tab-panel" data-panel="queue" style="display: block;">
            <div class="nzb-queue-panel">
                <div class="nzb-queue-header">
                    <div class="nzb-queue-title"><i class="fas fa-list-ul"></i> Download Queue</div>
                    <div class="nzb-queue-actions">
                        <button class="nzb-btn" title="Refresh"><i class="fas fa-sync-alt"></i></button>
                    </div>
                </div>
                <div id="nzb-queue-body">
                    <div class="nzb-queue-empty">
                        <div class="nzb-queue-empty-icon"><i class="fas fa-inbox"></i></div>
                        <h3>Queue is empty</h3>
                        <p>Downloads will appear here once NZB Hunt is connected to your Usenet setup.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- History panel -->
        <div class="nzb-tab-panel" data-panel="history" style="display: none;">
            <div class="nzb-queue-panel">
                <div class="nzb-queue-header">
                    <div class="nzb-queue-title"><i class="fas fa-history"></i> Download History</div>
                    <div class="nzb-queue-actions">
                        <button class="nzb-btn" title="Refresh"><i class="fas fa-sync-alt"></i></button>
                        <button class="nzb-btn nzb-btn-danger" title="Clear History"><i class="fas fa-trash-alt"></i>
                            Clear</button>
                    </div>
                </div>
                <div id="nzb-history-body">
                    <div class="nzb-queue-empty">
                        <div class="nzb-queue-empty-icon"><i class="fas fa-history"></i></div>
                        <h3>No history yet</h3>
                        <p>Completed downloads will be logged here.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Warnings panel -->
        <div class="nzb-tab-panel" data-panel="warnings" style="display: none;">
            <div class="nzb-queue-panel">
                <div class="nzb-queue-header">
                    <div class="nzb-queue-title"><i class="fas fa-exclamation-triangle"></i> Warnings</div>
                    <div class="nzb-queue-actions">
                        <button class="nzb-btn" title="Dismiss All" id="nzb-warnings-dismiss-all"><i
                                class="fas fa-check-double"></i> Dismiss All</button>
                    </div>
                </div>
                <div id="nzb-warnings-body">
                    <div class="nzb-queue-empty">
                        <div class="nzb-queue-empty-icon"><i class="fas fa-check-circle" style="color: #4ade80;"></i>
                        </div>
                        <h3>No warnings</h3>
                        <p>Everything looks good.</p>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <!-- ═══════ Display Preferences Modal (context-aware: queue / history) ═══════ -->
    <div class="nzb-prefs-overlay" id="nzb-prefs-overlay" style="display: none;">
        <div class="nzb-prefs-modal" id="nzb-prefs-modal">
            <div class="nzb-prefs-header">
                <h3><i class="fas fa-cog" style="margin-right: 8px; color: #6366f1;"></i><span
                        id="nzb-prefs-title">Display Settings</span></h3>
                <button class="nzb-prefs-close" id="nzb-prefs-close" title="Close">&times;</button>
            </div>
            <div class="nzb-prefs-body">

                <!-- Shared: refresh rate + items per page -->
                <div class="nzb-prefs-row">
                    <label class="nzb-prefs-label">Refresh rate</label>
                    <select class="nzb-prefs-select" id="nzb-pref-refresh">
                        <option value="1">1 second</option>
                        <option value="3">3 seconds</option>
                        <option value="5">5 seconds</option>
                        <option value="10">10 seconds</option>
                        <option value="30">30 seconds</option>
                        <option value="60">60 seconds</option>
                    </select>
                </div>

                <div class="nzb-prefs-row">
                    <label class="nzb-prefs-label">Items per page</label>
                    <select class="nzb-prefs-select" id="nzb-pref-per-page">
                        <option value="10">10</option>
                        <option value="20">20</option>
                        <option value="50">50</option>
                        <option value="100">100</option>
                    </select>
                </div>

                <!-- History-only settings -->
                <div id="nzb-prefs-history-section">
                    <div class="nzb-prefs-divider"></div>

                    <div class="nzb-prefs-row">
                        <label class="nzb-prefs-label">Date format</label>
                        <select class="nzb-prefs-select" id="nzb-pref-date-format">
                            <option value="relative">Relative (5 hours ago)</option>
                            <option value="absolute">Absolute (2/7/2026 6:23 PM)</option>
                        </select>
                    </div>

                    <div class="nzb-prefs-divider"></div>
                    <div class="nzb-prefs-section-title">Extra Columns</div>

                    <div class="nzb-prefs-row">
                        <label class="nzb-prefs-label">Category</label>
                        <label class="nzb-pref-toggle">
                            <input type="checkbox" id="nzb-pref-show-category" />
                            <span class="nzb-pref-slider"></span>
                        </label>
                    </div>
                    <div class="nzb-prefs-row">
                        <label class="nzb-prefs-label">Size</label>
                        <label class="nzb-pref-toggle">
                            <input type="checkbox" id="nzb-pref-show-size" />
                            <span class="nzb-pref-slider"></span>
                        </label>
                    </div>
                    <div class="nzb-prefs-row">
                        <label class="nzb-prefs-label">Indexer</label>
                        <label class="nzb-pref-toggle">
                            <input type="checkbox" id="nzb-pref-show-indexer" />
                            <span class="nzb-pref-slider"></span>
                        </label>
                    </div>
                </div>
            </div>
            <div class="nzb-prefs-footer">
                <button class="nzb-btn nzb-btn-primary" id="nzb-prefs-save"><i class="fas fa-save"></i> Save</button>
            </div>
        </div>
    </div>
</section>