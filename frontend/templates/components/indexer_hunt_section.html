<!-- Index Master — Centralized Indexer Management + Per-Instance Indexers -->
<section id="indexer-hunt-section" class="content-section" style="display: none;">
    <link rel="stylesheet" href="./static/css/indexer-hunt.css">
    {% with section_id='indexer-hunt' %}{% include 'components/sponsor_banners_partial.html' %}{% endwith %}

    <!-- No-instances warning box (same style as Media Management) -->
    <div id="indexer-hunt-no-instances" class="ih-no-instances" style="display: none;">
        <i class="fas fa-cube" aria-hidden="true"></i>
        <p class="no-instances-title">No instances configured</p>
        <p class="no-instances-desc">Configure a Movie Hunt or TV Hunt instance to manage indexers.</p>
        <a href="./#media-hunt-instances" class="no-instances-action-btn"><i class="fas fa-cog"></i> Configure instances</a>
    </div>
    <div id="indexer-hunt-content-wrapper" style="display: none;">
    <!-- ── Index Master Pool (central management) — shown first, up top ─────────── -->
    <div class="ih-page" id="ih-list-view">
        <div class="ih-page-header">
            <div class="ih-page-title">
                <i class="fas fa-search-plus"></i>
                <h2>Index Master Pool</h2>
            </div>
        </div>

        <!-- Index Master Pool: central indexer definitions (hidden when empty) -->
        <div class="ih-group-box" id="ih-group-box">
            <h3>Index Master Pool</h3>
            <div class="ih-card-grid" id="ih-card-grid"></div>
        </div>

        <!-- Empty state -->
        <div class="ih-empty" id="ih-empty-state" style="display: none;">
            <div class="ih-empty-icon"><i class="fas fa-satellite-dish"></i></div>
            <h3>No Indexers Configured</h3>
            <p>Add your first indexer to get started with centralized indexer management.</p>
            <button class="ih-btn-primary" id="ih-empty-add-btn">
                <i class="fas fa-plus"></i> Add Indexer
            </button>
        </div>
    </div>

    <!-- ── Editor view (full page, replaces list) ───────────── -->
    <div class="ih-page" id="ih-editor-view" style="display: none;">
        <div class="ih-editor-header">
            <div class="ih-editor-nav">
                <button type="button" class="ih-btn-ghost" id="ih-editor-back">
                    <i class="fas fa-arrow-left"></i> Back
                </button>
                <div class="ih-editor-breadcrumb">
                    <i class="fas fa-search-plus"></i>
                    <span>Index Master</span>
                    <i class="fas fa-chevron-right"></i>
                    <span id="ih-editor-breadcrumb-name">Add Indexer</span>
                </div>
            </div>
            <button type="button" class="ih-btn-primary" id="ih-editor-save">
                <i class="fas fa-save"></i> Save
            </button>
        </div>

        <div class="ih-editor-grid">
            <!-- Left: Connection Settings -->
            <div class="ih-editor-section">
                <div class="ih-editor-section-title">Connection Settings</div>
                <div class="ih-field">
                    <label for="ih-form-protocol">Protocol</label>
                    <select id="ih-form-protocol" class="ih-input">
                        <option value="usenet">Usenet</option>
                    </select>
                    <p class="ih-help-text">Determines whether NZBs (Usenet) or torrents appear. Torrent support is pending.</p>
                </div>
                <div class="ih-field">
                    <label for="ih-form-preset">Preset</label>
                    <select id="ih-form-preset" class="ih-input">
                        <option value="manual">Custom (Manual)</option>
                    </select>
                </div>
                <div class="ih-field">
                    <label for="ih-form-name">Name</label>
                    <input type="text" id="ih-form-name" class="ih-input" placeholder="Indexer name">
                </div>
                <div class="ih-field">
                    <label for="ih-form-display-name">Display Name <span class="ih-optional">(optional)</span></label>
                    <input type="text" id="ih-form-display-name" class="ih-input" placeholder="Custom display name">
                </div>
                <div class="ih-field">
                    <label for="ih-form-url">URL</label>
                    <input type="text" id="ih-form-url" class="ih-input" placeholder="https://...">
                </div>
                <div class="ih-field">
                    <label for="ih-form-api-path">API Path</label>
                    <input type="text" id="ih-form-api-path" class="ih-input" value="/api">
                </div>
                <div class="ih-field">
                    <label for="ih-form-api-key">API Key</label>
                    <input type="text" id="ih-form-api-key" class="ih-input" placeholder="Enter API key">
                </div>
            </div>

            <!-- Right: Configuration -->
            <div class="ih-editor-section">
                <div class="ih-editor-section-title">Configuration</div>
                <div class="ih-field">
                    <label for="ih-form-priority">Priority (1-99)</label>
                    <input type="number" id="ih-form-priority" class="ih-input" value="50" min="1" max="99">
                    <p class="ih-help-text">Lower number = higher priority. Results from higher-priority indexers are preferred.</p>
                </div>
                <div class="ih-field">
                    <label>Status</label>
                    <div class="ih-toggle-row">
                        <div class="ih-toggle active" id="ih-form-enabled"></div>
                        <span id="ih-form-enabled-label" class="ih-toggle-label">Enabled</span>
                    </div>
                </div>
                <div class="ih-field ih-test-area">
                    <button class="ih-btn-test" id="ih-form-test-btn">
                        <i class="fas fa-plug"></i> Test Connection
                    </button>
                    <div class="ih-test-result" id="ih-test-result"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- ── Instance Indexers (only when pool has indexers) ───────────────────────── -->
    <div class="app-content-panel ih-page-wrapper ih-instance-area" id="ih-instance-area" style="width:100%;padding:20px;margin:0;background:transparent;box-shadow:none;border:none;display:none;">
        <div class="media-hunt-settings-instance-bar" style="margin-bottom: 16px;">
            <select id="settings-indexers-instance-select" class="control-select" aria-label="Instance">
                <option value="">Loading...</option>
            </select>
        </div>
        <div class="settings-group indexer-settings-group ih-instance-indexers-group" style="background:rgba(15,23,42,0.4);border:1px solid rgba(148,163,184,0.08);border-radius:12px;padding:24px;margin:12px 0 20px 0;">
            <h3 style="margin:0 0 8px 0;padding:0 0 12px 0;font-size:1.1rem;font-weight:600;color:#f1f5f9;border-bottom:1px solid rgba(148,163,184,0.12);background:none;box-shadow:none;"><i class="fas fa-server" style="margin-right: 8px; font-size: 0.95rem;"></i>Instance Indexers</h3>
            <p style="font-size:0.85rem;color:#64748b;margin:0 0 16px 0;">Indexers for the selected TV or Movie Hunt instance. Import from the Index Master pool above.</p>
            <div class="instance-card-grid" id="indexer-instances-grid-unified">
                <div class="add-instance-card" data-app-type="indexer" data-source="indexer-hunt">
                    <div class="add-icon"><i class="fas fa-download" style="color: #6366f1;"></i></div>
                    <div class="add-text">Import from Index Master</div>
                </div>
            </div>
        </div>
        <div class="settings-group indexer-settings-group ih-import-panel" id="ih-import-panel" style="display: none; border-left: 3px solid #6366f1;">
            <h3><i class="fas fa-download" style="color: #6366f1; margin-right: 8px; font-size: 0.95rem;"></i>Import Indexers from Index Master</h3>
            <p class="ih-mgmt-desc">Select indexers to import to this instance. Imported indexers stay linked for API key and enable/disable sync.</p>
            <div class="ih-import-list" id="ih-import-list">
                <div style="color: #94a3b8; padding: 20px; text-align: center;">Loading available indexers...</div>
            </div>
            <div class="ih-import-actions" id="ih-import-actions" style="display: none;">
                <button type="button" class="ih-import-cancel-btn" id="ih-import-cancel">Cancel</button>
                <button type="button" class="ih-import-confirm-btn" id="ih-import-confirm">
                    <i class="fas fa-download"></i> Import Selected
                </button>
            </div>
        </div>
    </div>
    </div>
</section>
