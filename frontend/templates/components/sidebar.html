<!-- ===== MAIN SIDEBAR ===== -->
<div class="sidebar" id="sidebar">
    <div class="logo-container">
        <a href="https://huntarr.io" target="_blank" rel="noopener noreferrer"
            style="display: flex; align-items: center; text-decoration: none; color: inherit;">
            <img src="./static/logo/256.png" alt="Huntarr Logo" class="logo logo-large">
            <img src="./static/logo/32.png" alt="Huntarr Logo" class="logo logo-small">
            <h1>Huntarr</h1>
        </a>
    </div>

    <nav class="nav-menu">
        <div class="nav-group">
            <div class="nav-group-title">Core</div>
            <a href="#home" class="nav-item" id="homeNav">
                <div class="nav-icon-wrapper"><i class="fas fa-home"></i></div>
                <span>Home</span>
            </a>
            <a href="./#requestarr" class="nav-item" id="requestarrNav">
                <div class="nav-icon-wrapper"><i class="fas fa-plus-circle"></i></div>
                <span>Requests</span>
            </a>
            <a href="./#apps" class="nav-item" id="appsNav">
                <div class="nav-icon-wrapper"><i class="fas fa-th-large"></i></div>
                <span>Apps</span>
            </a>
            <a href="./#system" class="nav-item" id="systemNav">
                <div class="nav-icon-wrapper"><i class="fas fa-server"></i></div>
                <span>System</span>
            </a>
            <div class="nav-sub-group" id="system-sub">
                <a href="./#hunt-manager" class="nav-item nav-item-sub" id="mainSystemHuntManagerNav">
                    <div class="nav-icon-wrapper"><i class="fas fa-crosshairs"></i></div>
                    <span>Hunt Manager</span>
                </a>
                <a href="./#logs" class="nav-item nav-item-sub" id="mainSystemLogsNav">
                    <div class="nav-icon-wrapper"><i class="fas fa-list-alt"></i></div>
                    <span>Logs</span>
                </a>
                <a href="./#about" class="nav-item nav-item-sub" id="mainSystemAboutNav">
                    <div class="nav-icon-wrapper"><i class="fas fa-info-circle"></i></div>
                    <span>About</span>
                </a>
            </div>
            <a href="./#settings" class="nav-item" id="settingsNav">
                <div class="nav-icon-wrapper"><i class="fas fa-cog"></i></div>
                <span>Settings</span>
            </a>
            <div class="nav-sub-group" id="settings-sub">
                <a href="./#settings" class="nav-item nav-item-sub" id="mainSettingsMainNav">
                    <div class="nav-icon-wrapper"><i class="fas fa-sliders-h"></i></div>
                    <span>Main</span>
                </a>
                <a href="./#scheduling" class="nav-item nav-item-sub" id="mainSettingsSchedulingNav">
                    <div class="nav-icon-wrapper"><i class="fas fa-calendar-alt"></i></div>
                    <span>Scheduling</span>
                </a>
                <a href="./#notifications" class="nav-item nav-item-sub" id="mainSettingsNotificationsNav">
                    <div class="nav-icon-wrapper"><i class="fas fa-bell"></i></div>
                    <span>Notifications</span>
                </a>
                <a href="./#backup-restore" class="nav-item nav-item-sub" id="mainSettingsBackupRestoreNav">
                    <div class="nav-icon-wrapper"><i class="fas fa-database"></i></div>
                    <span>Backup / Restore</span>
                </a>
                <a href="./#settings-logs" class="nav-item nav-item-sub" id="mainSettingsLogsNav">
                    <div class="nav-icon-wrapper"><i class="fas fa-file-alt"></i></div>
                    <span>Logs</span>
                </a>
                <a href="./#user" class="nav-item nav-item-sub" id="mainSettingsUserNav">
                    <div class="nav-icon-wrapper"><i class="fas fa-user"></i></div>
                    <span>User</span>
                </a>
            </div>
        </div>

        <div class="nav-group" id="main-sidebar-beta-group">
            <div class="nav-group-title">Beta</div>
            <a href="./#movie-hunt-collection" class="nav-item" id="mediaCollectionNav">
                <div class="nav-icon-wrapper"><i class="fas fa-folder-open"></i></div>
                <span>Movie Hunt</span>
            </a>
            <a href="./#nzb-hunt-home" class="nav-item" id="nzbHuntSupportNav">
                <div class="nav-icon-wrapper"><i class="fas fa-download"></i></div>
                <span>NZB Hunt</span>
            </a>
        </div>
    </nav>

    <div class="sidebar-footer">
        <a href="https://plexguide.github.io/Huntarr.io/donate.html" class="sidebar-footer-sponsor" target="_blank" rel="noopener noreferrer">
            <i class="fas fa-heart"></i><span>Become a Sponsor</span>
        </a>
        <div class="dev-mode-indicator" id="sidebar-dev-indicator">
            <i class="fas fa-code"></i>
            <span><a href="https://github.com/Admin9705/" target="_blank" rel="noopener" id="sidebar-dev-username">Admin9705</a></span>
        </div>
    </div>
</div>

<!-- ===== MOVIE HUNT SIDEBAR ===== -->
<div class="sidebar movie-hunt-sidebar" id="movie-hunt-sidebar" style="display: none;">
    <div class="logo-container">
        <a href="https://huntarr.io" target="_blank" rel="noopener noreferrer"
            style="display: flex; align-items: center; text-decoration: none; color: inherit;">
            <img src="./static/logo/256.png" alt="Huntarr Logo" class="logo logo-large">
            <img src="./static/logo/32.png" alt="Huntarr Logo" class="logo logo-small">
            <h1>Huntarr</h1>
        </a>
    </div>
    <nav class="nav-menu">
        <div class="nav-group" id="movie-hunt-sidebar-huntarr-home-group">
            <div class="nav-group-title">Huntarr</div>
            <a href="#home" class="nav-item" id="movieHuntMainHomeNav">
                <div class="nav-icon-wrapper"><i class="fas fa-home"></i></div>
                <span>Home</span>
            </a>
        </div>
        <div class="nav-group">
            <div class="nav-group-title">Movie Hunt</div>
            <a href="./#movie-hunt-collection" class="nav-item" id="movieHuntCollectionNav">
                <div class="nav-icon-wrapper"><i class="fas fa-folder-open"></i></div>
                <span>Movie Collection</span>
            </a>
            <div class="nav-sub-group" id="movie-hunt-collection-sub">
                <a href="./#movie-hunt-calendar" class="nav-item nav-item-sub" id="movieHuntCalendarNav">
                    <div class="nav-icon-wrapper"><i class="fas fa-calendar-alt"></i></div>
                    <span>Calendar</span>
                </a>
                <a href="./#settings-import-media" class="nav-item nav-item-sub" id="movieHuntImportMediaNav">
                    <div class="nav-icon-wrapper"><i class="fas fa-file-import"></i></div>
                    <span>Import Media</span>
                </a>
            </div>
            <a href="./#activity-queue" class="nav-item" id="movieHuntActivityNav">
                <div class="nav-icon-wrapper"><i class="fas fa-clock"></i></div>
                <span>Activity</span>
            </a>
            <div class="nav-sub-group" id="movie-hunt-activity-sub">
                <a href="./#activity-queue" class="nav-item nav-item-sub" id="movieHuntActivityQueueNav">
                    <div class="nav-icon-wrapper"><i class="fas fa-list-ul"></i></div>
                    <span>Queue</span>
                </a>
                <a href="./#activity-history" class="nav-item nav-item-sub" id="movieHuntActivityHistoryNav">
                    <div class="nav-icon-wrapper"><i class="fas fa-history"></i></div>
                    <span>History</span>
                </a>
                <a href="./#activity-blocklist" class="nav-item nav-item-sub" id="movieHuntActivityBlocklistNav">
                    <div class="nav-icon-wrapper"><i class="fas fa-ban"></i></div>
                    <span>Blocklist</span>
                </a>
                <a href="./#logs-movie-hunt" class="nav-item nav-item-sub" id="movieHuntActivityLogsNav">
                    <div class="nav-icon-wrapper"><i class="fas fa-file-alt"></i></div>
                    <span>Logs</span>
                </a>
            </div>
            <a href="./#movie-hunt-settings" class="nav-item" id="movieHuntSettingsNav">
                <div class="nav-icon-wrapper"><i class="fas fa-cog"></i></div>
                <span>Settings</span>
            </a>
            <!-- Hidden by default until we know instances exist -->
            <div class="nav-sub-group" id="movie-hunt-settings-sub" style="display: none;">
                <a href="./#settings-movie-management" class="nav-item nav-item-sub" id="movieHuntSettingsMovieManagementNav">
                    <div class="nav-icon-wrapper"><i class="fas fa-film"></i></div>
                    <span>Movie Management</span>
                </a>
                <a href="./#settings-profiles" class="nav-item nav-item-sub" id="movieHuntSettingsProfilesNav">
                    <div class="nav-icon-wrapper"><i class="fas fa-id-card"></i></div>
                    <span>Profiles</span>
                </a>
                <a href="./#settings-sizes" class="nav-item nav-item-sub" id="movieHuntSettingsSizesNav">
                    <div class="nav-icon-wrapper"><i class="fas fa-weight-hanging"></i></div>
                    <span>Sizes</span>
                </a>
                <a href="./#settings-custom-formats" class="nav-item nav-item-sub" id="movieHuntSettingsCustomFormatsNav">
                    <div class="nav-icon-wrapper"><i class="fas fa-code"></i></div>
                    <span>Custom Formats</span>
                </a>
                <a href="./#settings-indexers" class="nav-item nav-item-sub" id="movieHuntSettingsIndexersNav">
                    <div class="nav-icon-wrapper"><i class="fas fa-server"></i></div>
                    <span>Indexers</span>
                </a>
                <a href="./#settings-clients" class="nav-item nav-item-sub" id="movieHuntSettingsClientsNav">
                    <div class="nav-icon-wrapper"><i class="fas fa-cloud-download-alt"></i></div>
                    <span>Clients</span>
                </a>
                <a href="./#settings-import-lists" class="nav-item nav-item-sub" id="movieHuntSettingsImportListsNav">
                    <div class="nav-icon-wrapper"><i class="fas fa-stream"></i></div>
                    <span>Import Lists</span>
                </a>
                <a href="./#settings-root-folders" class="nav-item nav-item-sub" id="movieHuntSettingsRootFoldersNav">
                    <div class="nav-icon-wrapper"><i class="fas fa-folder-open"></i></div>
                    <span>Root Folders</span>
                </a>
            </div>
            <script>
            // Check for Movie Hunt instances and show/hide settings sub-group
            (function() {
                function updateMovieHuntSettingsVisibility() {
                    var subGroup = document.getElementById('movie-hunt-settings-sub');
                    var collectionSub = document.getElementById('movie-hunt-collection-sub');
                    var importMediaItem = document.getElementById('movieHuntImportMediaNav');
                    if (!subGroup) return;
                    
                    fetch('./api/movie-hunt/instances')
                        .then(function(r) { return r.json(); })
                        .then(function(data) {
                            var instances = data.instances || [];
                            var hasInstances = instances.length > 0;
                            
                            // Allow setActiveNavItem to control visibility via 'expanded' class
                            // but force-hide if no instances exist
                            subGroup.style.display = hasInstances ? '' : 'none';
                            if (collectionSub) {
                                collectionSub.style.display = hasInstances ? '' : 'none';
                            }
                            
                            if (hasInstances) {
                                // Check for root folders to show/hide Import Media specifically
                                fetch('./api/movie-hunt/root-folders')
                                    .then(function(r) { return r.json(); })
                                    .then(function(rfData) {
                                        var rootFolders = rfData.root_folders || [];
                                        var hasRootFolders = rootFolders.length > 0;
                                        
                                        if (importMediaItem) {
                                            importMediaItem.style.display = hasRootFolders ? 'flex' : 'none';
                                        }
                                        // Refresh active state/expansion now that we know visibility
                                        if (typeof setActiveNavItem === 'function') setActiveNavItem();
                                    })
                                    .catch(function() {
                                        if (importMediaItem) importMediaItem.style.display = 'none';
                                    });
                            }
                        })
                        .catch(function() {
                            subGroup.style.display = 'none';
                            if (collectionSub) collectionSub.style.display = 'none';
                        });
                }
                
                // Run on page load
                if (document.readyState === 'loading') {
                    document.addEventListener('DOMContentLoaded', updateMovieHuntSettingsVisibility);
                } else {
                    updateMovieHuntSettingsVisibility();
                }
                
                // Expose globally so it can be called after instance creation/deletion or root folder changes
                window.updateMovieHuntSettingsVisibility = updateMovieHuntSettingsVisibility;
            })();
            </script>
        </div>
    </nav>
    <div class="sidebar-footer">
        <a href="https://plexguide.github.io/Huntarr.io/donate.html" class="sidebar-footer-sponsor" target="_blank" rel="noopener noreferrer">
            <i class="fas fa-heart"></i><span>Become a Sponsor</span>
        </a>
        <div class="dev-mode-indicator" id="sidebar-dev-indicator-movie-hunt">
            <i class="fas fa-code"></i>
            <span><a href="https://github.com/Admin9705/" target="_blank" rel="noopener" id="sidebar-dev-username-movie-hunt">Admin9705</a></span>
        </div>
    </div>
</div>

<!-- ===== NZB HUNT SIDEBAR ===== -->
<div class="sidebar nzb-hunt-sidebar" id="nzb-hunt-sidebar" style="display: none;">
    <div class="logo-container">
        <a href="https://huntarr.io" target="_blank" rel="noopener noreferrer"
            style="display: flex; align-items: center; text-decoration: none; color: inherit;">
            <img src="./static/logo/256.png" alt="Huntarr Logo" class="logo logo-large">
            <img src="./static/logo/32.png" alt="Huntarr Logo" class="logo logo-small">
            <h1>Huntarr</h1>
        </a>
    </div>
    <nav class="nav-menu">
        <div class="nav-group">
            <div class="nav-group-title">Huntarr</div>
            <a href="#home" class="nav-item" id="nzbHuntMainHomeNav">
                <div class="nav-icon-wrapper"><i class="fas fa-home"></i></div>
                <span>Home</span>
            </a>
        </div>
        <div class="nav-group">
            <div class="nav-group-title">NZB Hunt</div>
            <a href="./#nzb-hunt-home" class="nav-item" id="nzbHuntHomeNav">
                <div class="nav-icon-wrapper"><i class="fas fa-download"></i></div>
                <span>NZB Home</span>
            </a>
            <a href="./#nzb-hunt-settings" class="nav-item" id="nzbHuntSettingsNav">
                <div class="nav-icon-wrapper"><i class="fas fa-cog"></i></div>
                <span>Settings</span>
            </a>
            <div class="nav-sub-group" id="nzb-hunt-settings-sub">
                <a href="./#nzb-hunt-settings-folders" class="nav-item nav-item-sub" id="nzbHuntSettingsFoldersNav" data-nzb-tab="folders">
                    <div class="nav-icon-wrapper"><i class="fas fa-folder-open"></i></div>
                    <span>Folders</span>
                </a>
                <a href="./#nzb-hunt-settings-servers" class="nav-item nav-item-sub" id="nzbHuntSettingsServersNav" data-nzb-tab="servers">
                    <div class="nav-icon-wrapper"><i class="fas fa-server"></i></div>
                    <span>Servers</span>
                </a>
                <a href="./#nzb-hunt-settings-processing" class="nav-item nav-item-sub" id="nzbHuntSettingsProcessingNav" data-nzb-tab="processing">
                    <div class="nav-icon-wrapper"><i class="fas fa-cogs"></i></div>
                    <span>Processing</span>
                </a>
                <a href="./#nzb-hunt-settings-advanced" class="nav-item nav-item-sub" id="nzbHuntSettingsAdvancedNav" data-nzb-tab="advanced">
                    <div class="nav-icon-wrapper"><i class="fas fa-sliders-h"></i></div>
                    <span>Advanced</span>
                </a>
            </div>
        </div>
    </nav>
    <div class="sidebar-footer">
        <a href="https://plexguide.github.io/Huntarr.io/donate.html" class="sidebar-footer-sponsor" target="_blank" rel="noopener noreferrer">
            <i class="fas fa-heart"></i><span>Become a Sponsor</span>
        </a>
        <div class="dev-mode-indicator" id="sidebar-dev-indicator-nzb-hunt">
            <i class="fas fa-code"></i>
            <span><a href="https://github.com/Admin9705/" target="_blank" rel="noopener" id="sidebar-dev-username-nzb-hunt">Admin9705</a></span>
        </div>
    </div>
</div>

<!-- ===== REQUESTARR SIDEBAR ===== -->
<div class="sidebar requestarr-sidebar" id="requestarr-sidebar" style="display: none;">
    <div class="logo-container">
        <a href="https://huntarr.io" target="_blank" rel="noopener noreferrer"
            style="display: flex; align-items: center; text-decoration: none; color: inherit;">
            <img src="./static/logo/256.png" alt="Huntarr Logo" class="logo logo-large">
            <img src="./static/logo/32.png" alt="Huntarr Logo" class="logo logo-small">
            <h1>Huntarr</h1>
        </a>
    </div>
    <nav class="nav-menu">
        <div class="nav-group">
            <div class="nav-group-title">Huntarr</div>
            <a href="#home" class="nav-item" id="requestarrHomeNav">
                <div class="nav-icon-wrapper"><i class="fas fa-home"></i></div>
                <span>Home</span>
            </a>
        </div>
        <div class="nav-group">
            <div class="nav-group-title">Requests</div>
            <a href="./#requestarr-discover" class="nav-item" id="requestarrDiscoverNav">
                <div class="nav-icon-wrapper"><i class="fas fa-compass"></i></div>
                <span>Discover</span>
            </a>
            <a href="./#requestarr-tv" class="nav-item" id="requestarrTVNav">
                <div class="nav-icon-wrapper"><i class="fas fa-tv"></i></div>
                <span>TV Shows</span>
            </a>
            <a href="./#requestarr-movies" class="nav-item" id="requestarrMoviesNav">
                <div class="nav-icon-wrapper"><i class="fas fa-film"></i></div>
                <span>Movies</span>
            </a>
            <a href="./#requestarr-hidden" class="nav-item" id="requestarrHiddenNav">
                <div class="nav-icon-wrapper"><i class="fas fa-eye-slash"></i></div>
                <span>Hidden Media</span>
            </a>
            <a href="./#requestarr-smarthunt-settings" class="nav-item" id="requestarrSmartHuntSettingsNav">
                <div class="nav-icon-wrapper"><i class="fas fa-fire"></i></div>
                <span>Smart Hunt</span>
            </a>
            <a href="./#requestarr-settings" class="nav-item" id="requestarrSettingsNav">
                <div class="nav-icon-wrapper"><i class="fas fa-cog"></i></div>
                <span>Settings</span>
            </a>
        </div>
    </nav>
    <div class="sidebar-footer">
        <a href="https://plexguide.github.io/Huntarr.io/donate.html" class="sidebar-footer-sponsor" target="_blank" rel="noopener noreferrer">
            <i class="fas fa-heart"></i><span>Become a Sponsor</span>
        </a>
        <div class="dev-mode-indicator" id="sidebar-dev-indicator-requestarr">
            <i class="fas fa-code"></i>
            <span><a href="https://github.com/Admin9705/" target="_blank" rel="noopener" id="sidebar-dev-username-requestarr">Admin9705</a></span>
        </div>
    </div>
</div>

<!-- ===== APPS SIDEBAR ===== -->
<div class="sidebar apps-sidebar" id="apps-sidebar" style="display: none;">
    <div class="logo-container">
        <a href="https://huntarr.io" target="_blank" rel="noopener noreferrer"
            style="display: flex; align-items: center; text-decoration: none; color: inherit;">
            <img src="./static/logo/256.png" alt="Huntarr Logo" class="logo logo-large">
            <img src="./static/logo/32.png" alt="Huntarr Logo" class="logo logo-small">
            <h1>Huntarr</h1>
        </a>
    </div>
    <nav class="nav-menu">
        <div class="nav-group">
            <div class="nav-group-title">Huntarr</div>
            <a href="#home" class="nav-item" id="appsHomeNav">
                <div class="nav-icon-wrapper"><i class="fas fa-home"></i></div>
                <span>Home</span>
            </a>
        </div>
        <div class="nav-group">
            <div class="nav-group-title">Apps</div>
            <a href="./#sonarr" class="nav-item sonarr-app" id="appsSonarrNav">
                <div class="nav-icon-wrapper sonarr-icon">
                    <img src="./static/images/app-icons/sonarr.png" alt="Sonarr" class="app-icon-img">
                </div>
                <span>Sonarr</span>
            </a>
            <a href="./#radarr" class="nav-item radarr-app" id="appsRadarrNav">
                <div class="nav-icon-wrapper radarr-icon">
                    <img src="./static/images/app-icons/radarr.png" alt="Radarr" class="app-icon-img">
                </div>
                <span>Radarr</span>
            </a>
            <a href="./#lidarr" class="nav-item lidarr-app" id="appsLidarrNav">
                <div class="nav-icon-wrapper lidarr-icon">
                    <img src="./static/images/app-icons/lidarr.png" alt="Lidarr" class="app-icon-img">
                </div>
                <span>Lidarr</span>
            </a>
            <a href="./#readarr" class="nav-item readarr-app" id="appsReadarrNav">
                <div class="nav-icon-wrapper readarr-icon">
                    <img src="./static/images/app-icons/readarr.png" alt="Readarr" class="app-icon-img">
                </div>
                <span>Readarr</span>
            </a>
            <a href="./#whisparr" class="nav-item whisparr-app" id="appsWhisparrNav">
                <div class="nav-icon-wrapper whisparr-icon">
                    <img src="./static/images/app-icons/whisparr.png" alt="Whisparr V2" class="app-icon-img">
                </div>
                <span>Whisparr V2</span>
            </a>
            <a href="./#eros" class="nav-item eros-app" id="appsErosNav">
                <div class="nav-icon-wrapper eros-icon">
                    <img src="./static/images/app-icons/eros.png" alt="Whisparr V3" class="app-icon-img">
                </div>
                <span>Whisparr V3</span>
            </a>
            <a href="./#prowlarr" class="nav-item prowlarr-app" id="appsProwlarrNav">
                <div class="nav-icon-wrapper prowlarr-icon">
                    <img src="./static/images/app-icons/prowlarr.png" alt="Prowlarr" class="app-icon-img">
                </div>
                <span>Prowlarr</span>
            </a>
            <a href="./#swaparr" class="nav-item swaparr-app" id="appsSwaparrNav">
                <div class="nav-icon-wrapper swaparr-icon">
                    <i class="fas fa-exchange-alt"></i>
                </div>
                <span>Swaparr</span>
            </a>
        </div>
    </nav>
    <div class="sidebar-footer">
        <a href="https://plexguide.github.io/Huntarr.io/donate.html" class="sidebar-footer-sponsor" target="_blank" rel="noopener noreferrer">
            <i class="fas fa-heart"></i><span>Become a Sponsor</span>
        </a>
        <div class="dev-mode-indicator" id="sidebar-dev-indicator-apps">
            <i class="fas fa-code"></i>
            <span><a href="https://github.com/Admin9705/" target="_blank" rel="noopener" id="sidebar-dev-username-apps">Admin9705</a></span>
        </div>
    </div>
</div>

<!-- ===== SETTINGS SIDEBAR ===== -->
<div class="sidebar settings-sidebar" id="settings-sidebar" style="display: none;">
    <div class="logo-container">
        <a href="https://huntarr.io" target="_blank" rel="noopener noreferrer"
            style="display: flex; align-items: center; text-decoration: none; color: inherit;">
            <img src="./static/logo/256.png" alt="Huntarr Logo" class="logo logo-large">
            <img src="./static/logo/32.png" alt="Huntarr Logo" class="logo logo-small">
            <h1>Huntarr</h1>
        </a>
    </div>
    <nav class="nav-menu">
        <div class="nav-group">
            <div class="nav-group-title">Huntarr</div>
            <a href="#home" class="nav-item" id="settingsHomeNav">
                <div class="nav-icon-wrapper"><i class="fas fa-home"></i></div>
                <span>Home</span>
            </a>
        </div>
        <div class="nav-group">
            <div class="nav-group-title">Settings</div>
            <a href="./#settings" class="nav-item active" id="settingsMainNav">
                <div class="nav-icon-wrapper"><i class="fas fa-sliders-h"></i></div>
                <span>Main</span>
            </a>
            <a href="./#scheduling" class="nav-item" id="settingsSchedulingNav">
                <div class="nav-icon-wrapper"><i class="fas fa-calendar-alt"></i></div>
                <span>Scheduling</span>
            </a>
            <a href="./#notifications" class="nav-item" id="settingsNotificationsNav">
                <div class="nav-icon-wrapper"><i class="fas fa-bell"></i></div>
                <span>Notifications</span>
            </a>
            <a href="./#backup-restore" class="nav-item" id="settingsBackupRestoreNav">
                <div class="nav-icon-wrapper"><i class="fas fa-database"></i></div>
                <span>Backup / Restore</span>
            </a>
            <a href="./#settings-logs" class="nav-item" id="settingsLogsNav">
                <div class="nav-icon-wrapper"><i class="fas fa-file-alt"></i></div>
                <span>Logs</span>
            </a>
            <a href="./user" class="nav-item" id="settingsUserNav">
                <div class="nav-icon-wrapper"><i class="fas fa-user"></i></div>
                <span>User</span>
            </a>
        </div>
    </nav>
    <div class="sidebar-footer">
        <a href="https://plexguide.github.io/Huntarr.io/donate.html" class="sidebar-footer-sponsor" target="_blank" rel="noopener noreferrer">
            <i class="fas fa-heart"></i><span>Become a Sponsor</span>
        </a>
        <div class="dev-mode-indicator" id="sidebar-dev-indicator-settings">
            <i class="fas fa-code"></i>
            <span><a href="https://github.com/Admin9705/" target="_blank" rel="noopener" id="sidebar-dev-username-settings">Admin9705</a></span>
        </div>
    </div>
</div>

<script>
    // Function to set active nav item based on the current hash
    function setActiveNavItem() {
        const navItems = document.querySelectorAll('.nav-item');
        navItems.forEach(item => item.classList.remove('active'));

        let currentHash = window.location.hash;
        if (!currentHash) currentHash = '#home';

        let selector = null;

        // Main sidebar items
        if (currentHash === '#home') selector = '#homeNav';
        // System sub items
        else if (currentHash === '#system' || currentHash === '#hunt-manager') { selector = '#mainSystemHuntManagerNav'; expandSub('system-sub'); }
        else if (currentHash === '#logs') { selector = '#mainSystemLogsNav'; expandSub('system-sub'); }
        else if (currentHash === '#about') { selector = '#mainSystemAboutNav'; expandSub('system-sub'); }
        else if (currentHash === '#apps' || currentHash === '#sonarr' || currentHash === '#instance-editor') selector = '#appsNav';
        else if (currentHash === '#swaparr') selector = '#appsSwaparrNav';
        else if (currentHash === '#requestarr') selector = '#requestarrNav';
        // Apps sidebar
        else if (currentHash === '#radarr') selector = '#appsRadarrNav';
        else if (currentHash === '#lidarr') selector = '#appsLidarrNav';
        else if (currentHash === '#readarr') selector = '#appsReadarrNav';
        else if (currentHash === '#whisparr') selector = '#appsWhisparrNav';
        else if (currentHash === '#eros') selector = '#appsErosNav';
        else if (currentHash === '#prowlarr') selector = '#appsProwlarrNav';
        // Settings sub items
        else if (currentHash === '#settings') { selector = '#mainSettingsMainNav'; expandSub('settings-sub'); }
        else if (currentHash === '#scheduling') { selector = '#mainSettingsSchedulingNav'; expandSub('settings-sub'); }
        else if (currentHash === '#notifications') { selector = '#mainSettingsNotificationsNav'; expandSub('settings-sub'); }
        else if (currentHash === '#backup-restore') { selector = '#mainSettingsBackupRestoreNav'; expandSub('settings-sub'); }
        else if (currentHash === '#settings-logs') { selector = '#mainSettingsLogsNav'; expandSub('settings-sub'); }
        else if (currentHash === '#user') { selector = '#mainSettingsUserNav'; expandSub('settings-sub'); }
        // Movie Hunt settings
        else if (currentHash === '#settings-instance-management' || currentHash === '#movie-hunt-settings') { selector = '#movieHuntSettingsNav'; expandSub('movie-hunt-settings-sub'); }
        else if (currentHash === '#settings-movie-management') { selector = '#movieHuntSettingsMovieManagementNav'; expandSub('movie-hunt-settings-sub'); }
        else if (currentHash === '#settings-profiles') { selector = '#movieHuntSettingsProfilesNav'; expandSub('movie-hunt-settings-sub'); }
        else if (currentHash === '#settings-sizes') { selector = '#movieHuntSettingsSizesNav'; expandSub('movie-hunt-settings-sub'); }
        else if (currentHash === '#settings-custom-formats') { selector = '#movieHuntSettingsCustomFormatsNav'; expandSub('movie-hunt-settings-sub'); }
        else if (currentHash === '#settings-indexers') { selector = '#movieHuntSettingsIndexersNav'; expandSub('movie-hunt-settings-sub'); }
        else if (currentHash === '#settings-clients') { selector = '#movieHuntSettingsClientsNav'; expandSub('movie-hunt-settings-sub'); }
        else if (currentHash === '#settings-import-lists') { selector = '#movieHuntSettingsImportListsNav'; expandSub('movie-hunt-settings-sub'); }
        else if (currentHash === '#settings-import-media') { selector = '#movieHuntImportMediaNav'; expandSub('movie-hunt-collection-sub'); }
        else if (currentHash === '#settings-root-folders') { selector = '#movieHuntSettingsRootFoldersNav'; expandSub('movie-hunt-settings-sub'); }
        // Movie Hunt sections
        else if (currentHash === '#movie-hunt-home' || currentHash === '#movie-hunt-collection') { selector = '#movieHuntCollectionNav'; expandSub('movie-hunt-collection-sub'); }
        else if (currentHash === '#movie-hunt-calendar') { selector = '#movieHuntCalendarNav'; expandSub('movie-hunt-collection-sub'); }
        else if (currentHash === '#activity-queue') { selector = '#movieHuntActivityQueueNav'; expandSub('movie-hunt-activity-sub'); }
        else if (currentHash === '#activity-history') { selector = '#movieHuntActivityHistoryNav'; expandSub('movie-hunt-activity-sub'); }
        else if (currentHash === '#activity-blocklist') { selector = '#movieHuntActivityBlocklistNav'; expandSub('movie-hunt-activity-sub'); }
        else if (currentHash === '#activity-logs' || currentHash === '#logs-movie-hunt') { selector = '#movieHuntActivityLogsNav'; expandSub('movie-hunt-activity-sub'); }
        // NZB Hunt
        else if (currentHash.startsWith('#nzb-hunt-settings')) { selector = '#nzbHuntSettingsNav'; expandSub('nzb-hunt-settings-sub'); }
        // Requestarr
        else if (currentHash === '#requestarr-discover') selector = '#requestarrDiscoverNav';
        else if (currentHash === '#requestarr-tv') selector = '#requestarrTVNav';
        else if (currentHash === '#requestarr-movies') selector = '#requestarrMoviesNav';
        else if (currentHash === '#requestarr-hidden') selector = '#requestarrHiddenNav';
        else if (currentHash === '#requestarr-smarthunt-settings') selector = '#requestarrSmartHuntSettingsNav';
        else if (currentHash === '#requestarr-settings') selector = '#requestarrSettingsNav';
        else selector = '#homeNav';

        const activeItem = document.querySelector(selector);
        if (activeItem) activeItem.classList.add('active');

        // Collapse settings sub when not on settings
        var settingsHashes = ['#settings', '#scheduling', '#notifications', '#backup-restore', '#settings-logs', '#user'];
        if (settingsHashes.indexOf(currentHash) === -1) collapseSub('settings-sub');
        // Collapse system sub when not on system
        var systemHashes = ['#system', '#hunt-manager', '#logs', '#about'];
        if (systemHashes.indexOf(currentHash) === -1) collapseSub('system-sub');

        // Collapse Movie Hunt subs
        var mhSettingsHashes = ['#movie-hunt-settings', '#settings-instance-management', '#settings-movie-management', '#settings-profiles', '#settings-sizes', '#settings-custom-formats', '#settings-indexers', '#settings-clients', '#settings-import-lists', '#settings-root-folders'];
        if (mhSettingsHashes.indexOf(currentHash) === -1) collapseSub('movie-hunt-settings-sub');

        var mhActivityHashes = ['#activity-queue', '#activity-history', '#activity-blocklist', '#activity-logs', '#logs-movie-hunt'];
        if (mhActivityHashes.indexOf(currentHash) === -1) collapseSub('movie-hunt-activity-sub');

        var mhCollectionHashes = ['#movie-hunt-home', '#movie-hunt-collection', '#settings-import-media', '#movie-hunt-calendar'];
        if (mhCollectionHashes.indexOf(currentHash) === -1) collapseSub('movie-hunt-collection-sub');
    }

    function expandSub(id) {
        var el = document.getElementById(id);
        if (el) el.classList.add('expanded');
    }

    function collapseSub(id) {
        var el = document.getElementById(id);
        if (el) el.classList.remove('expanded');
    }

    window.addEventListener('hashchange', setActiveNavItem);
    // Run on initial load
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', setActiveNavItem);
    } else {
        setActiveNavItem();
    }
</script>
